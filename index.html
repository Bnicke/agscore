<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8" />
    <!-- Sets initial viewport load and disables zooming  -->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, height=device-height, width=device-width">
    <title>AGScore.se</title>
    
    <!-- Makes your prototype chrome-less once bookmarked to your phone's home screen -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="stylesheet" type="text/css" href="vendor/font-awesome/awesome.css" />
    <link rel="stylesheet" type="text/css" href="vendor/open-sans/open-sans.css" />
    <link rel="stylesheet" type="text/css" href="vendor/bootstrap/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="vendor/mobility/mobility.css" />
	<link rel="stylesheet" type="text/css" href="vendor/dynatable/jquery.dynatable.css" /> 
	<link rel="stylesheet" type="text/css" href="vendor/stacktable/stacktable.css" />
	<link rel="stylesheet" type="text/css" href="vendor/agscore/agscore.css" />
    
    <!--<script type="text/javascript" src="cordova.js"></script>-->
	<script type="text/javascript" src="vendor/jquery/jquery.js"></script>
    <script type="text/javascript" src="vendor/classified/classified.js"></script>
	<script type="text/javascript" src="vendor/doon/doon.js"></script>
	<script type="text/javascript" src="vendor/time/time.js"></script>
    <script type="text/javascript" src="vendor/mobility/mobility.js"></script>
    <script type="text/javascript" src="vendor/acquire/acquire.js"></script>
    <script type="text/javascript" src="vendor/handlebars/handlebars.js"></script>
	<script type="text/javascript" src="vendor/chops/chops.js"></script>
    <script type="text/javascript" src="vendor/cropper/cropper.js"></script>
    <script type="text/javascript" src="vendor/password/password.js"></script>
	<script type="text/javascript" src="vendor/dynatable/jquery.dynatable.js"></script>
	<script src="vendor/stacktable/stacktable.js" type="text/javascript"></script>
<script type="text/javascript">
function sortJSON(data, key, way) {
    return data.sort(function(a, b) {
        var x = a[key]; var y = b[key];
        if (way === '123' ) { return ((x < y) ? -1 : ((x > y) ? 1 : 0)); }
        if (way === '321') { return ((x > y) ? -1 : ((x < y) ? 1 : 0)); }
    });
}
function processingComplete(table) {
	$(table + " td:contains('undefined')").html('-');
	$(table + "-stacktable-small-only").remove();
	$(table).stacktable({headIndex:1});
}
function drawgymtable(ESurl,table) {
$.ajax({
  url: ESurl,
  error: function(){
	$.mobility.notify('Error fetching scores, is database running?', 'error')
  },
  success: function(data_tmp){
     var data = new Array();
     for (var i = 0; i < data_tmp.hits.hits.length; i++) {
	data.push(data_tmp.hits.hits[i]._source)
     }
     data = sortJSON(data,'total', '321');
     data = sortJSON(data,'class', '123');
     var rank = 0;
     var last_rank = 0;
     var total = 1000000;
     var klass = 'NONE';
     var classOptions = new Array();
     for (var n = 0; n < data.length; n++) {
	  if ( klass != data[n].class ) {
		rank = 1;
     		last_rank = 0;
		classOptions.push(data[n].class);
	  }
 	  if ( total > data[n].total ) {
 		rank = last_rank + 1; 
 	  } 
 	  total = data[n].total;
          data[n].rank = rank;
	  klass = data[n].class;
	  last_rank = last_rank + 1;
     }
     var $el = $("#" + table + "-search-class");
     $('#' + table + '-search-class option:gt(0)').remove();
      for (var i = 0; i < classOptions.length; i++) {
 	$el.append($("<option></option>")
        .attr("value", classOptions[i] ).text(classOptions[i]));
      }
     (function() {
      var dynatable = $('#' + table).dynatable({
      dataset: {
        records: data
      },
      inputs: {
         processingText: '<img style="width:100px;height:100px;top=50px;position: relative;top: 2em;left: 25px;" src="images/loading.gif"/>'
      },
      features: {
         paginate: false
      }
    })
   .bind('dynatable:afterUpdate', processingComplete("#" + table))
   .data('dynatable');
    $('#dynatable-query-search-' + table).keypress( function() {
	processingComplete("#" + table);
    });
$('#' + table + '-search-class').change( function(e) {
  var value = $(this).val();
  if (value === "") {
    dynatable.queries.remove("class");
  } else {
    dynatable.queries.add("class",value);
  }
  setTimeout(function() {processingComplete("#" + table);}, 100);
  dynatable.process();
});
  })();
  }
});
}
</script>
</head>
<body>
	<section class="screen current"></section>
    
    <footer class="foot">
        <nav class="foot-nav" data-do="foot-nav">
            <a class="foot-nav-item" data-do="go-back" data-on="click" href="#home">
                <i class="foot-nav-icon fa fa-home"></i>
                <span class="foot-nav-label">Home</span>
            </a>
            <a class="foot-nav-item" data-do="modal-open" data-on="click" href="#profile">
                <i class="foot-nav-icon fa fa-user"></i>
                <span class="foot-nav-label">Profile</span>
            </a>
            <a class="foot-nav-item" data-do="modal-open" data-on="click" href="#modal">
                <i class="foot-nav-icon fa fa-cog"></i>
                <span class="foot-nav-label">Settings</span>
            </a>
        </nav>
    </footer>
    
    <div id="modal" class="modal hide">
        <header class="head">
            <a class="head-link pull-right" href="#modal" data-do="modal-close" data-on="click">
                <i class="fa fa-times"></i>
            </a>
            <h1 class="title">Settings</h1>
        </header>
    
        <section class="body with-head">
            <p class="pad">
			<div class="focus">
  <label class="top">Select Competition</label>
  <select class="form-control">
    <option>KFUM KM 2015</option>
    <option>Någon tävling</option>
    <option>Tävling förra året</option>
  </select>
</div>
<h4 class="pad upper">Themes</h4>

                        <nav class="themes nav-list">
                <a href="javascript:void(0)">Blue</a>
                <a href="javascript:void(0)">Green</a>
                <a href="javascript:void(0)">Orange</a>
                <a href="javascript:void(0)">Pink</a>
                <a href="javascript:void(0)">Purple</a>
                <a href="javascript:void(0)">Red</a>

			</p>
        </section>
    </div>
    
    <div id="favorites" class="modal hide">
        <header class="head">
            <a class="head-link pull-right" href="#favorites" data-do="modal-close" data-on="click">
                <i class="fa fa-times"></i>
            </a>
            <h1 class="title">Favorites</h1>
        </header>
    
        <section class="body with-head">
            <nav class="nav-list">
                <a data-do="go-forward" data-on="click" href="#typography">Typography <i class="fa fa-plus"></i></a>
                <a data-do="go-forward" data-on="click" href="#tabs">Tabs <i class="fa fa-edit"></i></a>
                <a data-do="go-forward" data-on="click" href="#fields">Fields <i class="fa fa-chevron-right"></i><span class="badge">42</span></a>
                <a data-do="go-forward" data-on="click" href="#list">List <i class="fa fa-chevron-right"></i></a>
            </nav>
        </section>
    </div>
    
    <div id="profile" class="modal hide">
        <header class="head">
            <a class="head-link pull-right" href="#profile" data-do="modal-close" data-on="click">
                <i class="fa fa-times"></i>
            </a>
            <h1 class="title">Profile</h1>
        </header>
    
        <section class="body with-head">
            <div class="row pad">
                <div class="col-md-1 middle">
                    <i class="fa fa-user fa-5x"></i> 
                </div>
				<div class="login">
                <div class="col-md-11">
                    <div class="focus">
                        <label>Username</label>
                        <input type="text" class="form-control" placeholder="Enter Username" value="" />
                    </div>
                    <div class="focus">
                        <label>Password</label>
                        <input type="password" class="form-control" placeholder="Enter Password" />
                    </div                
                </div>
				<div>
            </div>
        </section>
    </div>
    
    <div id="popover" 
    	class="popover hide" 
        data-do="popover-close" 
        data-on="click" 
        data-target="#popover">
        <nav class="nav-list">
            <a data-do="go-forward" data-on="click" href="#typography">Typography</a>
            <a data-do="go-forward" data-on="click" href="#tabs">Tabs</a>
            <a data-do="go-forward" data-on="click" href="#fields">Fields</a>
            <a data-do="go-forward" data-on="click" href="#list">List</a>
            <a data-do="go-forward" data-on="click" href="#refresh">Refresh <i class="fa fa-chevron-right"></i></a>
        </nav>
    </div>
    
    <aside id="aside-left" class="aside aside-left">
    	<a class="btn btn-default pull-right" data-do="aside" data-on="click" href="#aside-left"><i class="fa fa-chevron-left"></i></a>
        <h2 class="pad">AGScore.se</h2>
		<h4 class="pad upper">Result</h4>
        <nav class="nav-list">
            <a data-do="go-forward" data-on="click" href="#floor">Floor<i class="fa fa-chevron-right"></i></a>
            <a data-do="go-forward" data-on="click" href="#pommelHorse">Pommel horse<i class="fa fa-chevron-right"></i></a>
            <a data-do="go-forward" data-on="click" href="#rings">Rings<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#vault">Vault<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#paralellBars">Paralell bars<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#highBar">High bar<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#allaround">All-around<i class="fa fa-chevron-right"></i></a>
        </nav>
		<h4 class="pad upper">Register Points</h4>
        <nav class="nav-list">
            <a data-do="go-forward" data-on="click" href="#none">Floor<i class="fa fa-chevron-right"></i></a>
            <a data-do="go-forward" data-on="click" href="#none">Pommel horse<i class="fa fa-chevron-right"></i></a>
            <a data-do="go-forward" data-on="click" href="#none">Still rings<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#none">Vault<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#none">Parallel bars<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#none">High bars<i class="fa fa-chevron-right"></i></a>
        </nav>
		<h4 class="pad upper">Administration</h4>
        <nav class="nav-list">
            <a data-do="go-forward" data-on="click" href="#none">Register<i class="fa fa-chevron-right"></i></a>
            <a data-do="go-forward" data-on="click" href="#none">Start list<i class="fa fa-chevron-right"></i></a>
            <a data-do="go-forward" data-on="click" href="#none">Backup/Restore<i class="fa fa-chevron-right"></i></a>
        </nav>
    </aside>
    
    <script id="home" type="text/html">
        <header class="head">
            <a class="head-btn btn btn-default pull-left" data-do="aside" data-on="click" href="#aside-left"><i class="fa fa-bars"></i></a>
            <h1 class="title">
            </h1>
        </header>
        
        <section class="body with-head with-foot">
			<h4 class="pad upper">AGscore.se</h4>
            <div class="focus">
            	<p> Competition: KFUM KM 2015
                </p>
                
            </div>
            <h4 class="pad upper">Results</h4>
		<nav class="nav-list">
            <a data-do="go-forward" data-on="click" href="#floor">Floor<i class="fa fa-chevron-right"></i></a>
            <a data-do="go-forward" data-on="click" href="#pommelHorse">Pommel horse<i class="fa fa-chevron-right"></i></a>
            <a data-do="go-forward" data-on="click" href="#rings">Rings<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#vault">Vault<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#parallelBars">Parallel bars<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#highBar">High bar<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#allaround">All-around<i class="fa fa-chevron-right"></i></a>
        </nav>
			
            <h4 class="pad upper">Register points</h4>
	<nav class="nav-list">
            <a data-do="go-forward" data-on="click" href="#none">Floor<i class="fa fa-chevron-right"></i></a>
            <a data-do="go-forward" data-on="click" href="#none">Pommel horse<i class="fa fa-chevron-right"></i></a>
            <a data-do="go-forward" data-on="click" href="#none">Still rings<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#none">Vault<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#none">Parallel bars<i class="fa fa-chevron-right"></i></a>
			<a data-do="go-forward" data-on="click" href="#none">High bars<i class="fa fa-chevron-right"></i></a>
        </nav>
	<h4 class="pad upper">Administration</h4>	
	<nav class="nav-list">
            <a data-do="go-forward" data-on="click" href="#none">Register<i class="fa fa-chevron-right"></i></a>
            <a data-do="go-forward" data-on="click" href="#none">Start list<i class="fa fa-chevron-right"></i></a>
            <a data-do="go-forward" data-on="click" href="#none">Backup/Restore<i class="fa fa-chevron-right"></i></a>
        </nav>	
        </section>
    </script>
       <script id="none" type="text/html">
        <header class="head">
            <a class="head-btn btn btn-default pull-left" data-do="go-back" data-on="click" href="#home">Back</a>
            <h1 class="title">Nothing yet.</h1>
        </header>
        <section class="body with-foot with-head pad">
<div class="hero" data-do="hero">
  <div class="frame">
<img src="images/bars.svg" />
<img src="images/floor.svg" />
<img src="images/hbars.svg" />
<img src="images/horse.svg" />
<img src="images/rings.svg" />
<img src="images/vault.svg" />

  </div>
</div>
     </section>
    </script>
  
      <script id="allaround" type="text/html">
        <header class="head">
            <a class="head-btn btn btn-default pull-left" data-do="go-back" data-on="click" href="#home">Back</a>
            <h1 class="title">All-around</h1>
        </header>
        <section class="body with-foot with-head pad">
<div class="focus">
  <label class="top">Select class:</label>
  <select id="allaround-table-search-class" class="form-control">
    <option></option>
  </select>
</div>
<table id="allaround-table" class="table table-condensed">
<thead>
<th>Class</th>
<th>Rank</th>
<th>Number</th>
<th>Gymnast</th>
<th>Born</th>
<th>Club</th>
<th>Floor</th>
<th>Pommel horse</th>
<th>Rings</th>
<th>Vault</th>
<th>Parallell bars</th>
<th>High bar</th>
<th>Total</th>
</thead>
 <tbody>
 </tbody>
</table>

<script>
drawgymtable("/ES/comp1/allaround/_search","allaround-table");
</script>
        </section>
    </script> 

      <script id="floor" type="text/html">
        <header class="head">
            <a class="head-btn btn btn-default pull-left" data-do="go-back" data-on="click" href="#home">Back</a>
            <h1 class="title">Floor</h1>
        </header>
        <section class="body with-foot with-head pad">
<div class="focus">
  <label class="top">Select class:</label>
  <select id="floor-table-search-class" class="form-control">
    <option></option>
  </select>
</div>
<table id="floor-table" class="table table-condensed">
<thead>
<th>Class</th>
<th>Rank</th>
<th>Number</th>
<th>Gymnast</th>
<th>Born</th>
<th>Club</th>
<th>Pen</th>
<th>D</th>
<th>E1</th>
<th>E2</th>
<th>E3</th>
<th>E4</th>
<th>Avg E</th>
<th>Base</th>
<th>E</th>
<th>Total</th>
</thead>
 <tbody>
 </tbody>
</table>

<script>
drawgymtable("/ES/comp1/floor/_search","floor-table");
</script>
        </section>
    </script>
       <script id="pommelHorse" type="text/html">
        <header class="head">
            <a class="head-btn btn btn-default pull-left" data-do="go-back" data-on="click" href="#home">Back</a>
            <h1 class="title">Pommel horse</h1>
        </header>
        <section class="body with-foot with-head pad">
<div class="focus">
  <label class="top">Select class:</label>
  <select id="pommelHorse-table-search-class" class="form-control">
    <option></option>
  </select>
</div>
<table id="pommelHorse-table" class="table table-condensed">
<thead>
<th>Class</th>
<th>Rank</th>
<th>Number</th>
<th>Gymnast</th>
<th>Born</th>
<th>Club</th>
<th>Pen</th>
<th>D</th>
<th>E1</th>
<th>E2</th>
<th>E3</th>
<th>E4</th>
<th>Avg E</th>
<th>Base</th>
<th>E</th>
<th>Total</th>
</thead>
 <tbody>
 </tbody>
</table>

<script>
drawgymtable("/ES/comp1/pommelHorse/_search","pommelHorse-table");
</script>
        </section>
 </script>
    
      <script id="rings" type="text/html">
        <header class="head">
            <a class="head-btn btn btn-default pull-left" data-do="go-back" data-on="click" href="#home">Back</a>
            <h1 class="title">Rings</h1>
        </header>
        <section class="body with-foot with-head pad">
<div class="focus">
  <label class="top">Select class:</label>
  <select id="rings-table-search-class" class="form-control">
    <option></option>
  </select>
</div>
<table id="rings-table" class="table table-condensed">
<thead>
<th>Class</th>
<th>Rank</th>
<th>Number</th>
<th>Gymnast</th>
<th>Born</th>
<th>Club</th>
<th>Pen</th>
<th>D</th>
<th>E1</th>
<th>E2</th>
<th>E3</th>
<th>E4</th>
<th>Avg E</th>
<th>Base</th>
<th>E</th>
<th>Total</th>
</thead>
 <tbody>
 </tbody>
</table>

<script>
drawgymtable("/ES/comp1/rings/_search","rings-table");
</script>
        </section>
    </script>
      <script id="vault" type="text/html">
        <header class="head">
            <a class="head-btn btn btn-default pull-left" data-do="go-back" data-on="click" href="#home">Back</a>
            <h1 class="title">Vault</h1>
        </header>
        <section class="body with-foot with-head pad">
<div class="focus">
  <label class="top">Select class:</label>
  <select id="vault-table-search-class" class="form-control">
    <option></option>
  </select>
</div>
<table id="vault-table" class="table table-condensed">
<thead>
<th>Class</th>
<th>Rank</th>
<th>Number</th>
<th>Gymnast</th>
<th>Born</th>
<th>Club</th>
<th>Pen</th>
<th>D</th>
<th>E1</th>
<th>E2</th>
<th>E3</th>
<th>E4</th>
<th>Avg E</th>
<th>Base</th>
<th>E</th>
<th>Total</th>
</thead>
 <tbody>
 </tbody>
</table>

<script>
drawgymtable("/ES/comp1/vault/_search","vault-table");
</script>
  </section>
    </script>

      <script id="parallelBars" type="text/html">
        <header class="head">
            <a class="head-btn btn btn-default pull-left" data-do="go-back" data-on="click" href="#home">Back</a>
            <h1 class="title">Paralell Bars</h1>
        </header>
        <section class="body with-foot with-head pad">
<div class="focus">
  <label class="top">Select class:</label>
  <select id="paralellBars-table-search-class" class="form-control">
    <option></option>
  </select>
</div>
<table id="paralellBars-table" class="table table-condensed">
<thead>
<th>Class</th>
<th>Rank</th>
<th>Number</th>
<th>Gymnast</th>
<th>Born</th>
<th>Club</th>
<th>Pen</th>
<th>D</th>
<th>E1</th>
<th>E2</th>
<th>E3</th>
<th>E4</th>
<th>Avg E</th>
<th>Base</th>
<th>E</th>
<th>Total</th>
</thead>
 <tbody>
 </tbody>
</table>

<script>
drawgymtable("/ES/comp1/paralellBars/_search","paralellBars-table");
</script>
  </section>
    </script>

      <script id="highBar" type="text/html">
        <header class="head">
            <a class="head-btn btn btn-default pull-left" data-do="go-back" data-on="click" href="#home">Back</a>
            <h1 class="title">High bar</h1>
        </header>
        <section class="body with-foot with-head pad">
<div class="focus">
  <label class="top">Select class:</label>
  <select id="highBar-table-search-class" class="form-control">
    <option></option>
  </select>
</div>
<table id="highBar-table" class="table table-condensed">
<thead>
<th>Class</th>
<th>Rank</th>
<th>Number</th>
<th>Gymnast</th>
<th>Born</th>
<th>Club</th>
<th>Pen</th>
<th>D</th>
<th>E1</th>
<th>E2</th>
<th>E3</th>
<th>E4</th>
<th>Avg E</th>
<th>Base</th>
<th>E</th>
<th>Total</th>
</thead>
 <tbody>
 </tbody>
</table>

<script>
drawgymtable("/ES/comp1/highBar/_search","highBar-table");
</script>
  </section>
    </script>

    <script type="text/javascript">
	//initialize
	jQuery.mobility.start();
	
	//config aquire
	require.config({ templates: { root: 'templates' } });
	
	//add header and footer spacing
	jQuery(window).trigger('mobility-swap-complete', function() {
		jQuery('section.screen.current').addClass('with-head with-foot');
	});
	
	//now load the home page
	jQuery.mobility.swap(jQuery('#home').html());
	
	//remote transition are pluggable in this manner
	jQuery(window).on('mobility-request', function(e, target, effect) {
		jQuery(window).one('mobility-swap-complete', function() {
			var current = jQuery('section.screen.current').addClass('loading');
			
			//remote call yes? lets use acquire!
			if(target === '/acquire') {
				require('templates/sample.html', function(html) {
					jQuery.mobility.swap(html);
				});
				
				return;
			}
			
			//Probably do Ajax instead of this
			setTimeout(function() {
				jQuery.mobility.swap(jQuery('#transition').html());
			}, 5000);
		});
		
		jQuery.mobility.swap('', 'slide-left');
	});
	
	//default refresh pagination
    var i = 0;
	jQuery(window).on('mobility-refresh', function(e, target, callback) {
		var rows = $(jQuery('#refresh-template').html());
		setTimeout(function() {
			callback(rows[(++i) % 4]);
		}, 1000);	
	});
	
	
	//default paginate pagination
	var j = 0;
	jQuery(window).on('mobility-paginate', function(e, target, callback) {
		setTimeout(function() {
			if(j === 3) {
				callback();
				jQuery('.pagi-wait').removeClass('hide');
				return;
			}
			
			callback(jQuery('#refresh-template').html());
			j++;
		}, 1000);	
	});
	
	jQuery(document).on('click', 'nav.themes a', function(e) {
		e.preventDefault();
		var color = this.innerHTML.toLowerCase();
		jQuery('<link />').attr({
			rel: 'stylesheet', 
			type: 'text/css',
			href: 'vendor/mobility/mobility-'+color+'.css' })
		.appendTo('head');
	});
    </script>
</body>
</html>
